
<!doctype html>
<html lang="pt" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../iniciando%20o%20swarm/">
      
      
        <link rel="next" href="../ingress/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.1">
    
    
      
        <title>Serviço - Univesp por Estudantes - Portal Docker</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.3bd4f189.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-31BRSLXRM1"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-31BRSLXRM1",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-31BRSLXRM1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="yellow">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#servico" class="md-skip">
          Pular para conteúdo
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabeçalho">
    <a href="../.." title="Univesp por Estudantes - Portal Docker" class="md-header__button md-logo" aria-label="Univesp por Estudantes - Portal Docker" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Univesp por Estudantes - Portal Docker
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Serviço
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="yellow"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Buscar" placeholder="Buscar" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Pesquisar">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Limpar" aria-label="Limpar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando busca
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Univesp-Computacao/o_mundo_dos_conteineres" title="Ir para repositório" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Univesp-Computacao/o_mundo_dos_conteineres
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Abas" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Inicio
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../docker/instala%C3%A7%C3%A3o/" class="md-tabs__link">
        Docker
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../o%20que%20%C3%A9%20swarm/" class="md-tabs__link md-tabs__link--active">
        Docker Swarm
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../Kubernetes/o%20que%20%C3%A9%20kubernetes/" class="md-tabs__link">
        Kubernetes
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navegação" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Univesp por Estudantes - Portal Docker" class="md-nav__button md-logo" aria-label="Univesp por Estudantes - Portal Docker" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Univesp por Estudantes - Portal Docker
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Univesp-Computacao/o_mundo_dos_conteineres" title="Ir para repositório" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Univesp-Computacao/o_mundo_dos_conteineres
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Inicio
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_2">
          Docker
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Docker" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Docker
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/instala%C3%A7%C3%A3o/" class="md-nav__link">
        Instalação
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker_hub/" class="md-nav__link">
        Docker Hub
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/fluxo_containers/" class="md-nav__link">
        Fluxo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/imagem/" class="md-nav__link">
        Imagem
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/volumes/" class="md-nav__link">
        Gerenciamento de Dados
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/redes/" class="md-nav__link">
        Rede
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/compose/" class="md-nav__link">
        Docker Compose
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/aprende_mais/" class="md-nav__link">
        Proximos Passos
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_3">
          Docker Swarm
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Docker Swarm" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Docker Swarm
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../o%20que%20%C3%A9%20swarm/" class="md-nav__link">
        O que é Swarm?
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../iniciando%20o%20swarm/" class="md-nav__link">
        Iniciando o Swarm
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Serviço
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Serviço
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Indice">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Indice
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#routing-mesh" class="md-nav__link">
    Routing Mesh
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerente" class="md-nav__link">
    Gerente
  </a>
  
    <nav class="md-nav" aria-label="Gerente">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#criando-gerentes" class="md-nav__link">
    Criando Gerentes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raft-na-pratica" class="md-nav__link">
    Raft na prática
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removendo-gerentes" class="md-nav__link">
    Removendo Gerentes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restricao-de-servicos" class="md-nav__link">
    Restrição de Serviços
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#replicas" class="md-nav__link">
    Replicas
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ingress/" class="md-nav__link">
        Ingress
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../docker%20stack/" class="md-nav__link">
        Docker Stack
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      
      
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        <label class="md-nav__link" for="__nav_4">
          Kubernetes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Kubernetes" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Kubernetes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Kubernetes/o%20que%20%C3%A9%20kubernetes/" class="md-nav__link">
        O que é Kubernetes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Kubernetes/instala%C3%A7%C3%A3o/" class="md-nav__link">
        Instalação
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Kubernetes/pods/" class="md-nav__link">
        Pods
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Kubernetes/projeto/" class="md-nav__link">
        Projeto
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Kubernetes/replicaset/" class="md-nav__link">
        ReplicaSet
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../Kubernetes/deployment/" class="md-nav__link">
        Deployment
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Indice">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Indice
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#routing-mesh" class="md-nav__link">
    Routing Mesh
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gerente" class="md-nav__link">
    Gerente
  </a>
  
    <nav class="md-nav" aria-label="Gerente">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#criando-gerentes" class="md-nav__link">
    Criando Gerentes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#raft-na-pratica" class="md-nav__link">
    Raft na prática
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removendo-gerentes" class="md-nav__link">
    Removendo Gerentes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restricao-de-servicos" class="md-nav__link">
    Restrição de Serviços
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#replicas" class="md-nav__link">
    Replicas
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="servico">Serviço<a class="headerlink" href="#servico" title="Permanent link">&para;</a></h1>
<p>Antes de subimos nossa primeira imagem, vamos realizar um teste, para entender melhor o fluxo que devemos seguir quando usamos o swarm:</p>
<ol>
<li>Escolha um dos nós trabalhadores</li>
<li>Execute o comando <strong>docker run -d -p 5000:5000 sposigor/app-flask-teste:1</strong></li>
<li>Libere a porta em <strong>OPEN PORT</strong> e digite <strong>5000</strong>:</li>
</ol>
<p><img alt="porta" loading="lazy" src="https://i.postimg.cc/FFSX4Sth/image.png" /></p>
<p>Ele vai abrir uma nova aba com a aplicação.</p>
<p>Se lembra de como funciona o swarm? Então, escolha outro nó trabalhador e execute o <strong>docker ps</strong>, faça o mesmo para o nó gerente e em ambos vamos ter esse resultado:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">     </span>COMMAND<span class="w">   </span>CREATED<span class="w">   </span>STATUS<span class="w">    </span>PORTS<span class="w">     </span>NAMES
</code></pre></div>
<p>Estranho né, se o swarm cria essa conexão com todos, porque o contêiner que subimos não foi refletido nos demais?</p>
<blockquote>
<p>É porque rodamos uma imagem local, e não no modo swarm.</p>
</blockquote>
<p>Certo, o modo swarm precisa de um comando mais específico para roda a imagem que é o <a href="https://docs.docker.com/engine/reference/commandline/service_create/" target="_blank">docker service create</a>.</p>
<p>Antes de executar, vamos remover a imagem local, vá ao terminal do nó que a imagem está rodando:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>docker<span class="w"> </span>rm<span class="w"> </span>56e3abd7f344<span class="w"> </span>--force
</code></pre></div>
<p>E agora sim, vamos criar nosso serviço:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Execute</label><label for="__tabbed_1_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>docker<span class="w"> </span>service<span class="w"> </span>create<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:5000<span class="w"> </span>sposigor/app-flask-teste:1
</code></pre></div>
<ul>
<li>A diferença é somente o comando inicial, <strong>service create</strong>, que vai permitir que todos os nós se comuniquem no modo swarm.</li>
</ul>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>Error<span class="w"> </span>response<span class="w"> </span>from<span class="w"> </span>daemon:<span class="w"> </span>This<span class="w"> </span>node<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>a<span class="w"> </span>swarm<span class="w"> </span>manager.<span class="w"> </span>Worker<span class="w"> </span>nodes<span class="w"> </span>can<span class="err">&#39;</span>t<span class="w"> </span>be<span class="w"> </span>used<span class="w"> </span>to<span class="w"> </span>view<span class="w"> </span>or<span class="w"> </span>modify<span class="w"> </span>cluster<span class="w"> </span>state.<span class="w"> </span>Please<span class="w"> </span>run<span class="w"> </span>this<span class="w"> </span><span class="nb">command</span><span class="w"> </span>on<span class="w"> </span>a<span class="w"> </span>manager<span class="w"> </span>node<span class="w"> </span>or<span class="w"> </span>promote<span class="w"> </span>the<span class="w"> </span>current<span class="w"> </span>node<span class="w"> </span>to<span class="w"> </span>a<span class="w"> </span>manager.
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Se você executou o comando em um nó trabalhador, vai receber o erro do qual os trabalhadores não podem iniciar um serviço, apesar do docker run executar, para subir uma imagem no modo swarm é preciso fazer através do gerente.</p>
<p>Vá ao nó gerente e execute o comando.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Execute</label><label for="__tabbed_2_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>docker<span class="w"> </span>service<span class="w"> </span>create<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:5000<span class="w"> </span>sposigor/app-flask-teste:1
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>9q3asggjagwfw89vrojc1urew
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>overall<span class="w"> </span>progress:<span class="w"> </span><span class="m">1</span><span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span><span class="m">1</span><span class="w"> </span>tasks
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="m">1</span>/1:<span class="w"> </span>running<span class="w">   </span><span class="o">[==================================================</span>&gt;<span class="o">]</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>verify:<span class="w"> </span>Service<span class="w"> </span>converged
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Então ele está informando que o <strong>Service converged</strong>, mas o que isso significa? Basicamente que ocorreu bem o processo de criação de um serviço e com isso ele criou uma tarefa: <strong>overall progress: 1 out of 1 tasks</strong>.</p>
<p>Vamos por partes, execute o <a href="https://docs.docker.com/engine/reference/commandline/service_ls/" target="_blank">docker servie ls</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Execute</label><label for="__tabbed_3_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>docker<span class="w"> </span>service<span class="w"> </span>ls
</code></pre></div>
<ul>
<li>Lembrando só o nó gerente pode executar</li>
</ul>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>ID<span class="w">             </span>NAME<span class="w">           </span>MODE<span class="w">         </span>REPLICAS<span class="w">   </span>IMAGE<span class="w">                        </span>PORTS
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>9q3asggjagwf<span class="w">   </span>epic_almeida<span class="w">   </span>replicated<span class="w">   </span><span class="m">1</span>/1<span class="w">        </span>sposigor/app-flask-teste:1<span class="w">   </span>*:5000-&gt;5000/tcp
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Analisar o cabeçalho para entender o que significa cada coluna:</p>
<ul>
<li><strong>ID</strong>: É o ID do serviço</li>
<li><strong>NAME</strong>: É o nome do serviço</li>
<li><strong>MODE</strong>: É o modo do serviço</li>
<li><strong>REPLICAS</strong>: É a quantidade de replicas</li>
<li><strong>IMAGE</strong>: É a imagem que o serviço está rodando</li>
<li><strong>PORTS</strong>: É a porta que está disponivel</li>
</ul>
<p>Para saber qual maquina está executando o container, use o <a href="https://docs.docker.com/engine/reference/commandline/service_ps/" target="_blank">docker service ps</a>, e passe o ID do serviço.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Execute</label><label for="__tabbed_4_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>docker<span class="w"> </span>service<span class="w"> </span>ps<span class="w"> </span>9q3asggjagwf
</code></pre></div>
<ul>
<li>Lembrando só o nó gerente pode executar</li>
<li>Se quiser como é possivel passar só alguns caracteres <strong>docker service ps 9q3</strong>, desde que não tenha outro serviço com o mesmo inicio.</li>
</ul>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>ID<span class="w">             </span>NAME<span class="w">             </span>IMAGE<span class="w">                        </span>NODE<span class="w">      </span>DESIRED<span class="w"> </span>STATE<span class="w">   </span>CURRENT<span class="w"> </span>STATE<span class="w">            </span>ERROR<span class="w">     </span>PORTS
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>3qpfhbbmigm4<span class="w">   </span>epic_almeida.1<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>node2<span class="w">     </span>Running<span class="w">         </span>Running<span class="w"> </span><span class="m">28</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">      </span>
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Analisar o cabeçalho para entender o que significa cada coluna:</p>
<ul>
<li><strong>ID</strong>: É o ID do serviço.</li>
<li><strong>NAME</strong>: É o nome do serviço.</li>
<li><strong>IMAGE</strong>: É a imagem que o serviço está rodando.</li>
<li><strong>NODE</strong>: É o nó que está executando a imagem naquele momento.</li>
<li><strong>DESIRED STATE</strong>: É o estado desejado da tarefa, pode está em (running, shutdown, or accepted).</li>
<li><strong>CURRENT STATE</strong>: É o estado atual da tarefa.</li>
<li><strong>ERROR</strong>: Se houver algum erro pe informado</li>
<li><strong>PORTS</strong>: É a porta que está disponível.</li>
</ul>
<p>Bem, agora que o serviço está disponível como swarm, vamos testa a aplicação em outras máquinas, vá em um nó trabalhador e libere a porta 5000.</p>
<p><img alt="liberando as portas" loading="lazy" src="https://media4.giphy.com/media/LE9a8WL8OCODLKtiw9/giphy.gif?cid=790b7611c5ce97dee2466ecf552a7a2dd243473e40b47250&amp;rid=giphy.gif&amp;ct=g" /></p>
<p>Por mais que apenas uma das máquinas esteja rodando a aplicação, ela está disponível na porta 5000 de todas as maquinas. Quem é que o cara que está ajudando a resolver esse problema é o <a href="https://docs.docker.com/engine/swarm/ingress/" target="_blank">Routing Mesh</a> através do Load balancing.</p>
<hr />
<h2 id="routing-mesh">Routing Mesh<a class="headerlink" href="#routing-mesh" title="Permanent link">&para;</a></h2>
<p>O modo swarm do Docker Engine facilita a publicação de portas para serviços para disponibilizá-los para recursos fora do swarm. Todos os nós, ficam disponíveis em uma malha de roteamento de entrada. A malha de roteamento permite que cada nó no enxame aceite conexões em portas publicadas para qualquer serviço em execução no enxame, mesmo que não haja nenhuma tarefa em execução no nó. A malha de roteamento roteia todas as solicitações de entrada para portas publicadas em nós disponíveis para um contêiner ativo.</p>
<p><img alt="Routing Mesh" loading="lazy" src="https://i.postimg.cc/HnfG7WXf/image.png" /></p>
<p>Testar na prática, vamos subir a mesma imagem na mesma porta para ver o que ocorre:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Execute</label><label for="__tabbed_5_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>docker<span class="w"> </span>service<span class="w"> </span>create<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:5000<span class="w"> </span>sposigor/app-flask-teste:1
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>Error<span class="w"> </span>response<span class="w"> </span>from<span class="w"> </span>daemon:<span class="w"> </span>rpc<span class="w"> </span>error:<span class="w"> </span><span class="nv">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>InvalidArgument<span class="w"> </span><span class="nv">desc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>port<span class="w"> </span><span class="s1">&#39;5000&#39;</span><span class="w"> </span>is<span class="w"> </span>already<span class="w"> </span><span class="k">in</span><span class="w"> </span>use<span class="w"> </span>by<span class="w"> </span>service<span class="w"> </span><span class="s1">&#39;epic_almeida&#39;</span><span class="w"> </span><span class="o">(</span>9q3asggjagwfw89vrojc1urew<span class="o">)</span><span class="w"> </span>as<span class="w"> </span>an<span class="w"> </span>ingress<span class="w"> </span>port
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>E assim ele nos dá um erro, para verificar melhor vamos remover o contêiner que no meu caso está rodando no node2:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Execute</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>docker<span class="w"> </span>rm<span class="w"> </span>6f21<span class="w"> </span>--force
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Voltei para o nó gerente e execute o <strong>docker service ls</strong>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Execute</label><label for="__tabbed_7_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>docker<span class="w"> </span>service<span class="w"> </span>ls
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>ID<span class="w">             </span>NAME<span class="w">           </span>MODE<span class="w">         </span>REPLICAS<span class="w">   </span>IMAGE<span class="w">                        </span>PORTS
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>9q3asggjagwf<span class="w">   </span>epic_almeida<span class="w">   </span>replicated<span class="w">   </span><span class="m">1</span>/1<span class="w">        </span>sposigor/app-flask-teste:1<span class="w">   </span>*:5000-&gt;5000/tcp
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Está dizendo que o serviço ainda está rodando, vamos usar o <a href="https://docs.docker.com/engine/reference/commandline/service_ps/" target="_blank">docker service ps</a> e passa o ID do serviço:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><input id="__tabbed_8_2" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">Execute</label><label for="__tabbed_8_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>docker<span class="w"> </span>service<span class="w"> </span>ps<span class="w"> </span>9q3asggjagwf
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>ID<span class="w">             </span>NAME<span class="w">                 </span>IMAGE<span class="w">                        </span>NODE<span class="w">      </span>DESIRED<span class="w"> </span>STATE<span class="w">   </span>CURRENT<span class="w"> </span>STATE<span class="w">           </span>ERROR<span class="w">                         </span>PORTS
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>f91ba1oajs39<span class="w">   </span>epic_almeida.1<span class="w">       </span>sposigor/app-flask-teste:1<span class="w">   </span>node3<span class="w">     </span>Running<span class="w">         </span>Running<span class="w"> </span><span class="m">2</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">                                 </span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>3qpfhbbmigm4<span class="w">    </span><span class="se">\_</span><span class="w"> </span>epic_almeida.1<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>node2<span class="w">     </span>Shutdown<span class="w">        </span>Failed<span class="w"> </span><span class="m">3</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">    </span><span class="s2">&quot;task: non-zero exit (137)&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<p>E o swarm se encarregou de subir a imagem automaticamente em outro nó, no caso do node2 para o node3, então se fomos lá na porta 5000 novamente, a aplicação vai estar rodando normalmente.</p>
<hr />
<h2 id="gerente">Gerente<a class="headerlink" href="#gerente" title="Permanent link">&para;</a></h2>
<p>Imagine que sem querer você desligue o computador que está o gerente? E agora será que deu ruim?</p>
<p>Sim, se você possui somente um gerente no seu swarm, o swarm vai ser desconfigurado, sendo necessário, reconfigurar o swarm. Mas os serviços param? Não, eles vão continuar, contudo, não existe mais ninguém para garantir a estabilidade do serviço.</p>
<p>Como podemos resolver essa categoria de situação? Basta fazer o backup da pasta do swarm.</p>
<p>Isso vai ser feito de forma manual, porque o docker não disponibiliza ainda nenhuma ferramenta para backup nesse sentido.</p>
<ol>
<li>Faça uma cópia da sua pasta que contém as informações do swarm, no Linux ela fica em <strong>/var/lib/docker/swarm/</strong></li>
<li>No Linux basta usar o comando <strong>cp -r /var/lib/docker/swarm/ backup</strong></li>
</ol>
<p>Agora com seu backup feito, para subir um swarm do zero com as configurações nesse backup:</p>
<ol>
<li>Vamos fazer o caminho inverso, <strong>cp -r backup/* /var/lib/docker/swarm/</strong></li>
<li>Durante a criação do swarm vamos passa uma nova flag <strong>--force-new-cluster</strong></li>
<li><strong>docker swarm init --force-new-cluster --advertise-addr 192.168.0.13</strong></li>
</ol>
<p>Essa é a fórmula mais usada para recuperação de swarm, independente do que tenha acontecido. Numa aplicação pequena, não faz sentido ter que criar esses backups, porém quando os serviços são muitos e a infraestrutura é maior ainda, é necessário ter garantias para recuperar rapidamente o estado anterior ao problema.</p>
<hr />
<h3 id="criando-gerentes">Criando Gerentes<a class="headerlink" href="#criando-gerentes" title="Permanent link">&para;</a></h3>
<p>Talvez, ter mais gerentes no seu swarm possa ajudar a resolve esse problema, afinal por mais que o backup seja uma solução, para determinadas situações, podemos simplesmente adicionar novos Gerentes.</p>
<p>Adicione mais uma instância no docker play e vamos passar para o token do comando <a href="https://docs.docker.com/engine/reference/commandline/swarm_join-token/" target="_blank">docker swarm join-token</a> e passe o manager:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><input id="__tabbed_9_2" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">Execute</label><label for="__tabbed_9_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>docker<span class="w"> </span>swarm<span class="w"> </span>join-token<span class="w"> </span>manager
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>To<span class="w"> </span>add<span class="w"> </span>a<span class="w"> </span>manager<span class="w"> </span>to<span class="w"> </span>this<span class="w"> </span>swarm,<span class="w"> </span>run<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>command:
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">    </span>docker<span class="w"> </span>swarm<span class="w"> </span>join<span class="w"> </span>--token<span class="w"> </span>SWMTKN-1-1waduqjabmpmygpy6xicwtt1srwbchelwnu8fsv3fj8qk4jdvi-8tke9gy4e6crw0euq2tki1m0y<span class="w"> </span><span class="m">192</span>.168.0.13:2377
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Vá à instância criada e execute o comando passado.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><input id="__tabbed_10_2" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">Execute</label><label for="__tabbed_10_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>docker<span class="w"> </span>swarm<span class="w"> </span>join<span class="w"> </span>--token<span class="w"> </span>SWMTKN-1-1waduqjabmpmygpy6xicwtt1srwbchelwnu8fsv3fj8qk4jdvi-8tke9gy4e6crw0euq2tki1m0y<span class="w"> </span><span class="m">192</span>.168.0.13:2377
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>This<span class="w"> </span>node<span class="w"> </span>joined<span class="w"> </span>a<span class="w"> </span>swarm<span class="w"> </span>as<span class="w"> </span>a<span class="w"> </span>manager.
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Se por acaso estive com a configuração de 1 gerente e 4 trabalhadores, basta derruba um dos trabalhadores e remover do swarm, e em seguida suba novamente como gerente.</p>
<p>Em um dos gerentes:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><input id="__tabbed_11_2" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">Execute</label><label for="__tabbed_11_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>docker<span class="w"> </span>node<span class="w"> </span>ls
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>ID<span class="w">                            </span>HOSTNAME<span class="w">   </span>STATUS<span class="w">    </span>AVAILABILITY<span class="w">   </span>MANAGER<span class="w"> </span>STATUS<span class="w">   </span>ENGINE<span class="w"> </span>VERSION
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>fhiexwgtupwto0yzz5i4nbve7<span class="w">     </span>node1<span class="w">      </span>Ready<span class="w">     </span>Active<span class="w">         </span>Leader<span class="w">           </span><span class="m">20</span>.10.0
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>x3ghs9kh5nftbnnd7otoyg4hu<span class="w">     </span>node2<span class="w">      </span>Ready<span class="w">     </span>Active<span class="w">                          </span><span class="m">20</span>.10.0
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>nufnx3dlv0orjgb0dm5li4aah<span class="w">     </span>node3<span class="w">      </span>Ready<span class="w">     </span>Active<span class="w">                          </span><span class="m">20</span>.10.0
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>jvxn6dt0zob66po3d5rdrbaru<span class="w">     </span>node4<span class="w">      </span>Ready<span class="w">     </span>Active<span class="w">                          </span><span class="m">20</span>.10.0
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>1bk98ofc3qasq9n6v298x4jjv<span class="w"> </span>*<span class="w">   </span>node5<span class="w">      </span>Ready<span class="w">     </span>Active<span class="w">         </span>Reachable<span class="w">        </span><span class="m">20</span>.10.0
</code></pre></div>
</div>
</div>
</div>
<p>E pronto o seu novo gerente já está rodando normalmente.</p>
<hr />
<h3 id="raft-na-pratica">Raft na prática<a class="headerlink" href="#raft-na-pratica" title="Permanent link">&para;</a></h3>
<p>Vamos reiniciar nossa aplicação no docker play feche com o close session e de outro start, lembrando dependendo o serviço pode estar cheio, mas basta continuar tentando até conseguir.</p>
<p>Click na chave de boca e selecione a opção:</p>
<p><img alt="Selecione" loading="lazy" src="https://i.postimg.cc/Y9WdtRZk/image.png" /></p>
<p>Após carregar a configuração, execute <strong>docker node ls</strong> em qualquer um dos gerentes:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><input id="__tabbed_12_2" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">Execute</label><label for="__tabbed_12_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>docker<span class="w"> </span>node<span class="w"> </span>ls
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>ID<span class="w">                            </span>HOSTNAME<span class="w">   </span>STATUS<span class="w">    </span>AVAILABILITY<span class="w">   </span>MANAGER<span class="w"> </span>STATUS<span class="w">   </span>ENGINE<span class="w"> </span>VERSION
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>3g4vyx694h4pd3dxlj442x88z<span class="w">     </span>manager1<span class="w">   </span>Ready<span class="w">     </span>Active<span class="w">         </span>Reachable<span class="w">        </span><span class="m">20</span>.10.0
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>lheo3at6gjkka6uoehk3lr0ow<span class="w"> </span>*<span class="w">   </span>manager2<span class="w">   </span>Ready<span class="w">     </span>Active<span class="w">         </span>Leader<span class="w">           </span><span class="m">20</span>.10.0
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>ptvwj6n2ums5o8b0lsfabhxgk<span class="w">     </span>manager3<span class="w">   </span>Ready<span class="w">     </span>Active<span class="w">         </span>Reachable<span class="w">        </span><span class="m">20</span>.10.0
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>n2230i73ivqhyqqg0ty2hw3nd<span class="w">     </span>worker1<span class="w">    </span>Ready<span class="w">     </span>Active<span class="w">                          </span><span class="m">20</span>.10.0
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>tdiufxyidqv47atj937ffthb1<span class="w">     </span>worker2<span class="w">    </span>Ready<span class="w">     </span>Active<span class="w">                          </span><span class="m">20</span>.10.0
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Agora temos 3 gerentes, sendo um deles o lider. Vamos derrubar o lider com <strong>docker swarm leave --force</strong> no terminal do lider.</p>
<p>Assim que executar vá em outro gerente:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><input id="__tabbed_13_2" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">Execute</label><label for="__tabbed_13_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>docker<span class="w"> </span>node<span class="w"> </span>ls
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>ID<span class="w">                            </span>HOSTNAME<span class="w">   </span>STATUS<span class="w">    </span>AVAILABILITY<span class="w">   </span>MANAGER<span class="w"> </span>STATUS<span class="w">   </span>ENGINE<span class="w"> </span>VERSION
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>3g4vyx694h4pd3dxlj442x88z<span class="w"> </span>*<span class="w">   </span>manager1<span class="w">   </span>Ready<span class="w">     </span>Active<span class="w">         </span>Leader<span class="w">           </span><span class="m">20</span>.10.0
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>lheo3at6gjkka6uoehk3lr0ow<span class="w">     </span>manager2<span class="w">   </span>Unknown<span class="w">   </span>Active<span class="w">         </span>Unreachable<span class="w">      </span><span class="m">20</span>.10.0
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>ptvwj6n2ums5o8b0lsfabhxgk<span class="w">     </span>manager3<span class="w">   </span>Ready<span class="w">     </span>Active<span class="w">         </span>Reachable<span class="w">        </span><span class="m">20</span>.10.0
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>n2230i73ivqhyqqg0ty2hw3nd<span class="w">     </span>worker1<span class="w">    </span>Ready<span class="w">     </span>Active<span class="w">                          </span><span class="m">20</span>.10.0
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>tdiufxyidqv47atj937ffthb1<span class="w">     </span>worker2<span class="w">    </span>Ready<span class="w">     </span>Active<span class="w">                          </span><span class="m">20</span>.10.0
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Temos um novo líder agora, que pe maneger1, enquanto o manager3 está com o <strong>MANAGER STATUS</strong> de <strong>Unreachable</strong>, ou seja, está fora do swarm por algum motivo.</p>
<p>O que ocorreu? O Raft, foi acionado para gera uma eleição, e o vencedor da eleição foi o maneger1.</p>
<p>Recomendação do docker sobre os gerentes, eles recomendam que tenhamos números impares, 3, 5 ou 7.</p>
<hr />
<h3 id="removendo-gerentes">Removendo Gerentes<a class="headerlink" href="#removendo-gerentes" title="Permanent link">&para;</a></h3>
<p>Vamos remover o nosso gerente que está <strong>Unreachable</strong>. Em qualquer gerente execute:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><input id="__tabbed_14_2" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">Execute</label><label for="__tabbed_14_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>docker<span class="w"> </span>node<span class="w"> </span>rm<span class="w"> </span>manager2
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>Error<span class="w"> </span>response<span class="w"> </span>from<span class="w"> </span>daemon:<span class="w"> </span>rpc<span class="w"> </span>error:<span class="w"> </span><span class="nv">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>FailedPrecondition<span class="w"> </span><span class="nv">desc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>node<span class="w"> </span>lheo3at6gjkka6uoehk3lr0ow<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>cluster<span class="w"> </span>manager<span class="w"> </span>and<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>member<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>raft<span class="w"> </span>cluster.<span class="w"> </span>It<span class="w"> </span>must<span class="w"> </span>be<span class="w"> </span>demoted<span class="w"> </span>to<span class="w"> </span>worker<span class="w"> </span>before<span class="w"> </span>removal
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>E ele deu um erro, ele está dizendo que precisamos rebaixar o menager2 para trabalhador antes de remover efetivamente do swarm, usando o <a href="https://docs.docker.com/engine/reference/commandline/node_demote/" loading="lazy">docker node demote</a>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:2"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><input id="__tabbed_15_2" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">Execute</label><label for="__tabbed_15_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>docker<span class="w"> </span>node<span class="w"> </span>demote<span class="w"> </span>manager2
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>Manager<span class="w"> </span>manager2<span class="w"> </span>demoted<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>swarm.
</code></pre></div>
</div>
</div>
</div>
<p>Agora é possível remover com o <strong>docker node rm</strong>, faça e vamos adicionar o gerente no swarm com o <strong>docker swarm join-token manager</strong> pegue o comando que ele retorna e cola no gerente que você removeu.</p>
<hr />
<h2 id="restricao-de-servicos">Restrição de Serviços<a class="headerlink" href="#restricao-de-servicos" title="Permanent link">&para;</a></h2>
<p>Por padrão o docker permite que o gerente rode serviços, ou seja, é possível que a maquina que vai efetivamente roda alguma imagem seja um gerente e não um trabalhador. Mas vamos supor que por algum motivo você não quer permitir que o gerente rode qualquer serviço, ou só quer determinado serviço rode no gerente.</p>
<p>Então podemos resolver da seguinte forma:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:4"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><input id="__tabbed_16_2" name="__tabbed_16" type="radio" /><input id="__tabbed_16_3" name="__tabbed_16" type="radio" /><input id="__tabbed_16_4" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">1</label><label for="__tabbed_16_2">2</label><label for="__tabbed_16_3">3</label><label for="__tabbed_16_4">4</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Suba a imagem</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>docker<span class="w"> </span>service<span class="w"> </span>create<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:5000<span class="w"> </span>sposigor/app-flask-teste:1
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>docker<span class="w"> </span>node<span class="w"> </span>ls
</code></pre></div>
<p>E a saída:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>ID<span class="w">                            </span>HOSTNAME<span class="w">   </span>STATUS<span class="w">    </span>AVAILABILITY<span class="w">   </span>MANAGER<span class="w"> </span>STATUS<span class="w">   </span>ENGINE<span class="w"> </span>VERSION
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>3g4vyx694h4pd3dxlj442x88z<span class="w">     </span>manager1<span class="w">   </span>Ready<span class="w">     </span>Active<span class="w">         </span>Leader<span class="w">           </span><span class="m">20</span>.10.0
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>3xtgnz4d2098nnhjrq5ilv7l6<span class="w"> </span>*<span class="w">   </span>manager2<span class="w">   </span>Ready<span class="w">     </span>Active<span class="w">         </span>Reachable<span class="w">        </span><span class="m">20</span>.10.0
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>ptvwj6n2ums5o8b0lsfabhxgk<span class="w">     </span>manager3<span class="w">   </span>Ready<span class="w">     </span>Active<span class="w">         </span>Reachable<span class="w">        </span><span class="m">20</span>.10.0
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>n2230i73ivqhyqqg0ty2hw3nd<span class="w">     </span>worker1<span class="w">    </span>Ready<span class="w">     </span>Active<span class="w">                          </span><span class="m">20</span>.10.0
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>tdiufxyidqv47atj937ffthb1<span class="w">     </span>worker2<span class="w">    </span>Ready<span class="w">     </span>Active<span class="w">                          </span><span class="m">20</span>.10.0
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Aqui vamos alterar o estado da <strong>AVAILABILITY</strong>, para conseguimos fazer essa restrição do nó.
Enquanto estiver como <strong>Active</strong> significa que está disponível para roda serviços.
Para alterar vamos usar o <a href="https://docs.docker.com/engine/reference/commandline/node_update/" target="_blank">docker node update</a>
Vamos passa a flag <strong>--availability</strong> que tem 3 estados ("active"|"pause"|"drain").
No nosso caso queremos usar o <strong>drain</strong> para que o gerente não execute nenhum serviço.
Por fim basta passa qual maquina você quer alterar o estado.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>docker<span class="w"> </span>node<span class="w"> </span>update<span class="w"> </span>--availability<span class="w"> </span>drain<span class="w"> </span>manager2
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Rode novamente o <strong>docker node ls</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>docker<span class="w"> </span>node<span class="w"> </span>ls
</code></pre></div>
<p>Saida:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>ID<span class="w">                            </span>HOSTNAME<span class="w">   </span>STATUS<span class="w">    </span>AVAILABILITY<span class="w">   </span>MANAGER<span class="w"> </span>STATUS<span class="w">   </span>ENGINE<span class="w"> </span>VERSION
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>3g4vyx694h4pd3dxlj442x88z<span class="w">     </span>manager1<span class="w">   </span>Ready<span class="w">     </span>Active<span class="w">         </span>Leader<span class="w">           </span><span class="m">20</span>.10.0
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>3xtgnz4d2098nnhjrq5ilv7l6<span class="w"> </span>*<span class="w">   </span>manager2<span class="w">   </span>Ready<span class="w">     </span>Drain<span class="w">          </span>Reachable<span class="w">        </span><span class="m">20</span>.10.0
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>ptvwj6n2ums5o8b0lsfabhxgk<span class="w">     </span>manager3<span class="w">   </span>Ready<span class="w">     </span>Active<span class="w">         </span>Reachable<span class="w">        </span><span class="m">20</span>.10.0
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>n2230i73ivqhyqqg0ty2hw3nd<span class="w">     </span>worker1<span class="w">    </span>Ready<span class="w">     </span>Active<span class="w">                          </span><span class="m">20</span>.10.0
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>tdiufxyidqv47atj937ffthb1<span class="w">     </span>worker2<span class="w">    </span>Ready<span class="w">     </span>Active<span class="w">                          </span><span class="m">20</span>.10.0
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Assim conseguimos alterar a <strong>AVAILABILITY</strong> do <strong>manager2</strong> para a <strong>Drain</strong> e com isso ele se torna inacessivel para executar serviços, mas continuar a executar a atividade de gerente normalmente.</p>
<p>Mas vamos supor que você queira fazer isso em todos os gerentes de uma vez, vamos ter que alterar 1 por 1? Não, vamos usar um comando mais generalista que vai definir aonde queremos que o serviço rode. Usando o <a href="https://docs.docker.com/engine/reference/commandline/service_update/" target="_blank">docker service update</a> e passando a flag <strong>--constraint-add</strong> que vai restrigir determido serviço para um grupo especifico.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:2"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><input id="__tabbed_17_2" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">Execute</label><label for="__tabbed_17_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Vamos passa para o comando a flag <strong>--constraint-add</strong>
Nesse caso queremos especificar um tipo de nó, então vamos usar o <strong>node.role==worker</strong>
E por ultimo vamos passa o ID do serviço para saber qual serviço vamos aplicar essa restrição</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>docker<span class="w"> </span>service<span class="w"> </span>update<span class="w"> </span>--constraint-add<span class="w"> </span>node.role<span class="o">==</span>worker<span class="w"> </span>gnj34gs43ebi
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>gnj34gs43ebi
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>overall<span class="w"> </span>progress:<span class="w"> </span><span class="m">1</span><span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span><span class="m">1</span><span class="w"> </span>tasks
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="m">1</span>/1:<span class="w"> </span>running<span class="w">   </span><span class="o">[==================================================</span>&gt;<span class="o">]</span>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>verify:<span class="w"> </span>Service<span class="w"> </span>converged
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Alguns cuidados durante a restrição desses serviços, vamos supor que você faça essa restrição usando um nó que não existe, ele vai rodar o comando e todas as suas aplicações se tornaram indisponiveis, porque a restrição que houve, restringiu para um nó inexistente.</p>
<ul>
<li>Quando restringir o serviços nos gerente?</li>
</ul>
<p>Queremos rodar serviços no manager, que são serviços de monitoramento, serviços de segurança, ou seja, serviços que são críticos, que dependemos na nossa aplicação. É importante pondera essa questão, para entender quais são os pontos criticos da aplicação.</p>
<hr />
<h2 id="replicas">Replicas<a class="headerlink" href="#replicas" title="Permanent link">&para;</a></h2>
<p>Já vimos essa palavra aqui:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="18:2"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><input id="__tabbed_18_2" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">Execute</label><label for="__tabbed_18_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>docker<span class="w"> </span>service<span class="w"> </span>ls
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>ID<span class="w">             </span>NAME<span class="w">              </span>MODE<span class="w">         </span>REPLICAS<span class="w">   </span>IMAGE<span class="w">                        </span>PORTS
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>gnj34gs43ebi<span class="w">   </span>dazzling_lamarr<span class="w">   </span>replicated<span class="w">   </span><span class="m">1</span>/1<span class="w">        </span>sposigor/app-flask-teste:1<span class="w">   </span>*:5000-&gt;5000/tcp
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Certo o que significa isso, bem para explicar a gente precisa descobrir aonde nosso serviço está rodando:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:2"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio" /><input id="__tabbed_19_2" name="__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="__tabbed_19_1">Execute</label><label for="__tabbed_19_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>docker<span class="w"> </span>service<span class="w"> </span>ps<span class="w"> </span>gnj34gs43ebi
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>ID<span class="w">             </span>NAME<span class="w">                </span>IMAGE<span class="w">                        </span>NODE<span class="w">      </span>DESIRED<span class="w"> </span>STATE<span class="w">   </span>CURRENT<span class="w"> </span>STATE<span class="w">            </span>ERROR<span class="w">     </span>PORTS
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>w105x64ylhne<span class="w">   </span>dazzling_lamarr.1<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>worker2<span class="w">   </span>Running<span class="w">         </span>Running<span class="w"> </span><span class="m">37</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">      </span>
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>O serviço está rodando no <strong>worker2</strong>, para explicar vamos repassar pelo conceito de Load Balancing. Quando a porta 5000 é acessada independete da maquina que estiver no swarm, a aplicação é diponibilizada, porém se houver interação, vamos supor que haja um cadastro de um usuario, o que ocorre na pratica é que essa alteração vai ser redirecionada para a maquina que está rodando essa imagem. E a Replica serve para isso, para que possamos usar mais de uma maquina nesse processo de processamento dessa demanda. Então vamos replicar essa imagem, que para outras maquinas com o <a href="https://docs.docker.com/engine/reference/commandline/service_update/" target="_blank">docker service update</a>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:2"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio" /><input id="__tabbed_20_2" name="__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="__tabbed_20_1">Execute</label><label for="__tabbed_20_2">Saida</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>docker<span class="w"> </span>service<span class="w"> </span>update<span class="w"> </span>--replicas<span class="w"> </span><span class="m">8</span><span class="w"> </span>gnj34gs43ebi
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>gnj34gs43ebi
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>overall<span class="w"> </span>progress:<span class="w"> </span><span class="m">4</span><span class="w"> </span>out<span class="w"> </span>of<span class="w"> </span><span class="m">4</span><span class="w"> </span>tasks
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="m">1</span>/4:<span class="w"> </span>running<span class="w">   </span><span class="o">[==================================================</span>&gt;<span class="o">]</span>
<a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="m">2</span>/4:<span class="w"> </span>running<span class="w">   </span><span class="o">[==================================================</span>&gt;<span class="o">]</span>
<a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="m">3</span>/4:<span class="w"> </span>running<span class="w">   </span><span class="o">[==================================================</span>&gt;<span class="o">]</span>
<a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="m">4</span>/4:<span class="w"> </span>running<span class="w">   </span><span class="o">[==================================================</span>&gt;<span class="o">]</span>
<a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>verify:<span class="w"> </span>Service<span class="w"> </span>converged<span class="w">     </span>
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Vamos executar o <strong>docker service ls</strong> para verificar como está as réplicas:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="21:4"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio" /><input id="__tabbed_21_2" name="__tabbed_21" type="radio" /><input id="__tabbed_21_3" name="__tabbed_21" type="radio" /><input id="__tabbed_21_4" name="__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="__tabbed_21_1">docker service ls</label><label for="__tabbed_21_2">docker service ps</label><label for="__tabbed_21_3">Removendo --constraint-rm</label><label for="__tabbed_21_4">8 Replicas</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>docker<span class="w"> </span>service<span class="w"> </span>ls
</code></pre></div>
<p>Lembrando só o nó gerente pode executar</p>
<p>Saida:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>ID<span class="w">             </span>NAME<span class="w">              </span>MODE<span class="w">         </span>REPLICAS<span class="w">   </span>IMAGE<span class="w">                        </span>PORTS
<a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>gnj34gs43ebi<span class="w">   </span>dazzling_lamarr<span class="w">   </span>replicated<span class="w">   </span><span class="m">4</span>/4<span class="w">        </span>sposigor/app-flask-teste:1<span class="w">   </span>*:5000-&gt;5000/tcp
</code></pre></div>
<p>Temos agora, 4 replicas</p>
</div>
<div class="tabbed-block">
<p>Para saber quais maquinas estão rodando o serviço:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>docker<span class="w"> </span>service<span class="w"> </span>ps<span class="w"> </span>gnj34gs43ebi
</code></pre></div>
<p>Saida:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>ID<span class="w">             </span>NAME<span class="w">                </span>IMAGE<span class="w">                        </span>NODE<span class="w">      </span>DESIRED<span class="w"> </span>STATE<span class="w">   </span>CURRENT<span class="w"> </span>STATE<span class="w">            </span>ERROR<span class="w">     </span>PORTS
<a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>w105x64ylhne<span class="w">   </span>dazzling_lamarr.1<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>worker2<span class="w">   </span>Running<span class="w">         </span>Running<span class="w"> </span><span class="m">52</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">             </span>
<a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>v9bmopdi3nr3<span class="w">   </span>dazzling_lamarr.2<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>worker1<span class="w">   </span>Running<span class="w">         </span>Running<span class="w"> </span><span class="m">3</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">              </span>
<a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>sp81t2z56n67<span class="w">   </span>dazzling_lamarr.3<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>worker1<span class="w">   </span>Running<span class="w">         </span>Running<span class="w"> </span><span class="m">4</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">              </span>
<a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a>oxdvxulccegb<span class="w">   </span>dazzling_lamarr.4<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>worker2<span class="w">   </span>Running<span class="w">         </span>Running<span class="w"> </span><span class="m">5</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>
</code></pre></div>
<p>Lembrando que fizemo a restrição para somente workes executarem as tarefas.
Vamos remover a restrição e tentar novamente com 8 replicas</p>
</div>
<div class="tabbed-block">
<ul>
<li>Vamos passar os mesmos parâmetros que usamos para restringir os serviços</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>docker<span class="w"> </span>service<span class="w"> </span>update<span class="w"> </span>--constraint-rm<span class="w"> </span>node.role<span class="o">==</span>worker<span class="w"> </span>gnj34gs43ebi
</code></pre></div>
</div>
<div class="tabbed-block">
<ul>
<li>Já vamos passar 8 no parâmetro.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>docker<span class="w"> </span>service<span class="w"> </span>update<span class="w"> </span>--replicas<span class="w"> </span><span class="m">8</span><span class="w"> </span>gnj34gs43ebi
</code></pre></div>
<p>Em seguida:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>docker<span class="w"> </span>service<span class="w"> </span>ps<span class="w"> </span>gnj34gs43ebi
</code></pre></div>
<p>E a saída:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>ID<span class="w">             </span>NAME<span class="w">                </span>IMAGE<span class="w">                        </span>NODE<span class="w">       </span>DESIRED<span class="w"> </span>STATE<span class="w">   </span>CURRENT<span class="w"> </span>STATE<span class="w">               </span>ERROR<span class="w">     </span>PORTS
<a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>w105x64ylhne<span class="w">   </span>dazzling_lamarr.1<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>worker2<span class="w">    </span>Running<span class="w">         </span>Running<span class="w"> </span>about<span class="w"> </span>an<span class="w"> </span>hour<span class="w"> </span>ago<span class="w">             </span>
<a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>v9bmopdi3nr3<span class="w">   </span>dazzling_lamarr.2<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>worker1<span class="w">    </span>Running<span class="w">         </span>Running<span class="w"> </span><span class="m">17</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">                </span>
<a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a>sp81t2z56n67<span class="w">   </span>dazzling_lamarr.3<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>worker1<span class="w">    </span>Running<span class="w">         </span>Running<span class="w"> </span><span class="m">17</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">                </span>
<a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>oxdvxulccegb<span class="w">   </span>dazzling_lamarr.4<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>worker2<span class="w">    </span>Running<span class="w">         </span>Running<span class="w"> </span><span class="m">18</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">                </span>
<a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a>gs8m3brh4sw6<span class="w">   </span>dazzling_lamarr.5<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>manager3<span class="w">   </span>Running<span class="w">         </span>Running<span class="w"> </span><span class="m">3</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">                 </span>
<a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a>sr1u0kr19hut<span class="w">   </span>dazzling_lamarr.6<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>manager3<span class="w">   </span>Running<span class="w">         </span>Running<span class="w"> </span><span class="m">3</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">                 </span>
<a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a>z80bqt30sscq<span class="w">   </span>dazzling_lamarr.7<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>manager3<span class="w">   </span>Running<span class="w">         </span>Running<span class="w"> </span><span class="m">3</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">                 </span>
<a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a>2yjmab0lkl7q<span class="w">   </span>dazzling_lamarr.8<span class="w">   </span>sposigor/app-flask-teste:1<span class="w">   </span>manager1<span class="w">   </span>Running<span class="w">         </span>Running<span class="w"> </span><span class="m">3</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">    </span>
</code></pre></div>
</div>
</div>
</div>
<hr />
<p>Com isso agora temos diversas maquinas rodando nosso serviço, ou seja, o poder de processamento aumentou. Porque assim que ocorrer uma demanda de processamento, o load balancing por trás vai estar resolvendo isso.</p>
<p>Também é possível usar o <a href="https://docs.docker.com/engine/reference/commandline/service_scale/" target="_blank">docker service scale</a>, vamos passar o ID do serviço e a quantidade de réplicas para escalar</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>docker<span class="w"> </span>service<span class="w"> </span>scale<span class="w"> </span><span class="nv">gnj34gs43ebi</span><span class="o">=</span><span class="m">6</span>
</code></pre></div>
<hr />
<p>Temos também a opção de passar diretamente na criação do serviço, basta passa a flag <strong>--mode</strong> e o parâmetro <strong>global</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>docker<span class="w"> </span>service<span class="w"> </span>create<span class="w"> </span>-p<span class="w"> </span><span class="m">5000</span>:5000<span class="w"> </span>--mode<span class="w"> </span>global<span class="w"> </span>sposigor/app-flask-teste:1
</code></pre></div>
<p>É importante lembrar que não é recomendado passar todos os serviços com o parâmetro global, afinal isso vai exigir um consumo que poderia ser poupado da aplicação no processador individual. Seja sempre critico com essa necessidade.</p>


  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  


  
    
  



  


<h4>Cookie consent</h4>
<p>Usamos cookies para reconhecer suas visitas repetidas e preferências. Com o seu consentimento, você está nos ajudando a
 tornar nossa documentação melhor.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        <label>
      </li>
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="github" checked>
          <span class="task-list-indicator"></span>
          GitHub
        <label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.tabs.link", "navigation.expand", "navigation.indexes", "navigation.sections", "navigation.tabs", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.12658920.min.js", "translations": {"clipboard.copied": "Copiado para \u00e1rea de Transfer\u00eancia", "clipboard.copy": "Copiar para \u00e1rea de Transfer\u00eancia", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "Nenhum documento encontrado", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Digite para iniciar a busca", "search.result.term.missing": "Perdido", "select.version": "Selecione a vers\u00e3o"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5cf534bf.min.js"></script>
      
    
  </body>
</html>